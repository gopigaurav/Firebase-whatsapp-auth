(this["webpackJsonpFirebase-whatsapp-auth"]=this["webpackJsonpFirebase-whatsapp-auth"]||[]).push([[0],{50:function(e,t,a){},72:function(e,t,a){},74:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var c=a(4),s=a(2),n=a.n(s),r=a(26),i=a.n(r),o=(a(72),a(14)),j=(a(50),a(44)),l=a.n(j),d=a(53),h=a(106),b=a(101),u=a(104),p=(a(74),a(102)),m=a(103),O=a(57),x=a.n(O),f=a(58),v=a.n(f),g=a(9),_=a(29),w=_.a.initializeApp({apiKey:"AIzaSyBx9EkRXW2JIh0DpW0TjxCyTDBhE0cqjYs",authDomain:"whatsapp-clone-49aaf.firebaseapp.com",projectId:"whatsapp-clone-49aaf",storageBucket:"whatsapp-clone-49aaf.appspot.com",messagingSenderId:"662152507017",appId:"1:662152507017:web:ece390635501b9e8d56058",measurementId:"G-S8TN6KXEJL"}).firestore(),N=_.a.auth(),S=new _.a.auth.GoogleAuthProvider,C=w,y=Object(s.createContext)(),I=function(e){var t=e.reducer,a=e.initialState,n=e.children;return Object(c.jsx)(y.Provider,{value:Object(s.useReducer)(t,a),children:n})},T=function(){return Object(s.useContext)(y)};var D=function(){var e,t,a=Object(s.useState)([]),n=Object(o.a)(a,2),r=n[0],i=n[1],j=Object(g.f)().roomId,O=Object(s.useState)(""),f=Object(o.a)(O,2),w=f[0],N=f[1],S=Object(s.useState)([]),y=Object(o.a)(S,2),I=y[0],D=y[1],E=T(),k=Object(o.a)(E,2),F=k[0].user;k[1],Object(s.useEffect)((function(){j&&(C.collection("rooms").doc(j).onSnapshot((function(e){return N(e.data().name)})),C.collection("rooms").doc(j).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){return D(e.docs.map((function(e){return e.data()})))})))}),[j]);var B=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),C.collection("rooms").doc(j).collection("messages").add({message:r,name:F.displayName,timestamp:_.a.firestore.FieldValue.serverTimestamp()}),console.log(i),i("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.jsxs)("div",{className:"chat",children:[Object(c.jsxs)("div",{className:"chat__header",children:[Object(c.jsx)(h.a,{src:"https://c4.wallpaperflare.com/wallpaper/756/185/281/women-model-long-hair-brunette-wallpaper-preview.jpg"}),Object(c.jsxs)("div",{className:"chat__headerInfo",children:[Object(c.jsx)("h3",{children:w}),Object(c.jsxs)("p",{children:["last seen"," ",new Date(null===(e=I[I.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()]})]}),Object(c.jsxs)("div",{className:"chat__headerRight",children:[Object(c.jsx)(b.a,{children:Object(c.jsx)(p.a,{})}),Object(c.jsx)(b.a,{children:Object(c.jsx)(m.a,{})}),Object(c.jsx)(b.a,{children:Object(c.jsx)(u.a,{})})]})]}),Object(c.jsxs)("div",{className:"chat__body",children:[Object(c.jsxs)("p",{className:"chat__message",children:[Object(c.jsx)("span",{className:"chat__name",children:"gopi"}),"Fullstack whatsapp-Clone with Firestore | Yesss",Object(c.jsx)("span",{className:"chat__timestamp",children:(new Date).toUTCString()})]}),I.map((function(e){var t;return Object(c.jsxs)("p",{className:"chat__message ".concat("chat__receiver"),children:[Object(c.jsx)("span",{className:"chat__name",children:e.name}),e.message,Object(c.jsx)("span",{className:"chat__timestamp",children:new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toUTCString()})]})}))]}),Object(c.jsxs)("div",{className:"chat__footer",children:[Object(c.jsx)(x.a,{}),Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{value:r,onChange:function(e){return i(e.target.value)},placeholder:"Type a message",type:"text"}),Object(c.jsx)("button",{onClick:B,type:"submit",children:"Send a message"})]}),Object(c.jsx)(v.a,{})]})]})},E=(a(84),a(60)),k=a.n(E),F=a(59),B=a.n(F),P=a(61),R=a.n(P),A=(a(85),a(35));var L=function(e){var t=e.addNewChat,a=e.id,n=e.name,r=Object(s.useState)(""),i=Object(o.a)(r,2),j=i[0],l=i[1],d=Object(s.useState)(""),b=Object(o.a)(d,2),u=(b[0],b[1]);return Object(s.useEffect)((function(){l(Math.floor(5e3*Math.random()))}),[]),Object(s.useEffect)((function(){C.collection("rooms").doc(a).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return u(e.docs.map((function(e){return e.data})))}))}),[a]),t?Object(c.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat");e&&C.collection("rooms").add({name:e})},className:"sidebarChat",children:Object(c.jsx)("h2",{children:"Add new Chat"})}):Object(c.jsx)(A.b,{to:"/rooms/".concat(a),children:Object(c.jsxs)("div",{className:"sidebarChat",children:[Object(c.jsx)(h.a,{src:"https://avatars.dicebear.com/api/human/".concat(j,".svg")}),Object(c.jsxs)("div",{className:"sidebarChat__info",children:[Object(c.jsx)("h2",{children:n}),Object(c.jsx)("p",{children:"Last Seen ..."})]})]})})};var U=function(){var e=T(),t=Object(o.a)(e,2),a=t[0].user,n=(t[1],Object(s.useState)([])),r=Object(o.a)(n,2),i=r[0],j=r[1];return Object(s.useEffect)((function(){var e=C.collection("rooms").onSnapshot((function(t){return j(t.docs.map((function(e){return{id:e.id,data:e.data()}}))),function(){e()}}))}),[]),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"sidebar__header",children:[Object(c.jsx)(h.a,{src:null===a||void 0===a?void 0:a.photoURL}),Object(c.jsx)("h1",{children:"gopi"}),Object(c.jsxs)("div",{className:"sidebar__headerRight",children:[Object(c.jsx)(b.a,{children:Object(c.jsx)(B.a,{})}),Object(c.jsx)(b.a,{children:Object(c.jsx)(k.a,{})}),Object(c.jsx)(b.a,{children:Object(c.jsx)(R.a,{})})]})]}),Object(c.jsx)("div",{className:"sidebar__search",children:Object(c.jsxs)("div",{className:"sidebar__searchContainer",children:[Object(c.jsx)(p.a,{}),Object(c.jsx)("input",{placeholder:"Search or start new chat",type:"text"})]})}),Object(c.jsxs)("div",{className:"sidebar__chats",children:[Object(c.jsx)(L,{addNewChat:!0}),i.map((function(e){return Object(c.jsx)(L,{id:e.id,name:e.data.name},e.id)}))]})]})},J=a(62),W=a(105),G=(a(86),a(47)),M="SET_USER",z=function(e,t){switch(console.log(t),t.type){case M:return Object(G.a)(Object(G.a)({},e),{},{user:t.user});default:return e}};var K=function(){var e=T(),t=Object(o.a)(e,2);Object(J.a)(t[0]);var a=t[1];return Object(c.jsx)("div",{className:"login",children:Object(c.jsxs)("div",{className:"login__container",children:[Object(c.jsx)("img",{className:"login__containerImage",src:"https://p7.hiclipart.com/preview/922/489/218/whatsapp-icon-logo-whatsapp-logo-png.jpg",alt:"whatsapp-logo"}),Object(c.jsx)("div",{className:"login__text",children:Object(c.jsx)("h1",{children:"Sign in to WhatsApp"})}),Object(c.jsx)(W.a,{onClick:function(){N.signInWithPopup(S).then((function(e){a({type:M,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in with Google"})]})})};var X=function(){var e=T(),t=Object(o.a)(e,2),a=t[0].user;return t[1],Object(c.jsx)("div",{className:"app",children:a?Object(c.jsx)("div",{className:"app__body",children:Object(c.jsxs)(A.a,{children:[Object(c.jsx)(U,{}),Object(c.jsxs)(g.c,{children:[Object(c.jsx)(g.a,{path:"/rooms/:roomId",children:Object(c.jsx)(D,{})}),Object(c.jsx)(g.a,{path:"/",children:Object(c.jsx)(D,{})})]})]})}):Object(c.jsx)(K,{})})},Y=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,107)).then((function(t){var a=t.getCLS,c=t.getFID,s=t.getFCP,n=t.getLCP,r=t.getTTFB;a(e),c(e),s(e),n(e),r(e)}))};i.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(I,{initialState:{user:null},reducer:z,children:Object(c.jsx)(X,{})})}),document.getElementById("root")),Y()}},[[88,1,2]]]);
//# sourceMappingURL=main.265aba23.chunk.js.map